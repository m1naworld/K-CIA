---

# **[PRD] K-CIA Lite: 성수동 하이퍼로컬 상권 분석 플랫폼**

**버전:** 1.1

**상태:** Draft (기획 설계 단계)

**작성일:** 2026-01-26

**최종 수정:** 2026-01-30

---

## **1. 제품 개요 (Product Overview)**

본 서비스는 성수동의 **'정량적 팩트(공공데이터)'**와 **'정성적 트렌드(유튜브)'**를 결합하여, 사용자가 복잡한 분석 도구 없이도 지도와 대화만으로 실질적인 상권 인사이트를 얻을 수 있게 돕는 **AI 오케스트레이션 대시보드**입니다.

* **한 줄 정의:** "성수동의 어제와 오늘을 3D 지도와 대화로 읽어주는 AI 컨설턴트"
* **핵심 가치:** 데이터 지체 현상(Lagging) 극복, 의사결정 직관성 확보, 복합 데이터 추론의 자동화.

---

## **2. 타겟 유저 및 문제 정의**

### **Target Audience**

1. **예비 창업자:** 성수동 내 특정 골목의 입지 조건과 경쟁 강도를 파악하려는 개인.
2. **부동산/마케팅 전문가:** 팝업 스토어 입지 선정 및 소셜 미디어 반응을 실시간으로 확인해야 하는 실무자.

### **Problem Statement**

* **공공데이터의 후행성:** 3개월 전 매출 데이터로는 매주 바뀌는 성수동 트렌드를 따라잡기 힘듦.
* **데이터 해석의 어려움:** 방대한 엑셀 데이터를 비전문가가 분석하여 인사이트를 도출하는 데 한계가 있음.
* **파편화된 정보:** 유동 인구와 실제 방문객의 감정(리뷰)이 연결되지 않아 "왜 매출이 올랐는가?"에 대한 답을 찾기 어려움.

---

## **3. 핵심 기능 (Functional Requirements)**

### **FR-1: 3D 인터랙티브 헥사곤 맵**

* **요구사항:** 성수동 상권을 육각형(Hexagon) 그리드로 나누어 시각화.
* **상세 로직:**
  * **Elevation (높이):** 유동 인구 수 또는 추정 매출액 반영.
  * **Color (색상):** MVP에서는 매출증감률(QoQ)을 반영하여 붉은색(감소)~녹색(증가)으로 표현. 유튜브 모듈 활성화 시 감성 점수(-1.0~1.0)로 전환 가능.
  * **Interaction:** 그리드 클릭 시 해당 구역의 요약 지표 사이드바 노출.

### **FR-2: 랭그래프(LangGraph) 기반 AI 챗봇**

* **요구사항:** 복합적인 질의에 대해 데이터에 근거한 답변 생성.
* **상세 로직:**
  * **Supervisor:** 질문을 분석해 SQL(정량) 또는 감성 분석(정성) 에이전트에게 업무 할당.
  * **Multi-Agent:** 매출 데이터 쿼리(SQL)와 유튜브 댓글 요약(Map-Reduce)을 동시에 수행 후 종합 의견 제시.

### **FR-3: 하이브리드 데이터 수집 엔진**

* **요구사항:** 이질적인 데이터 소스를 자동화된 파이프라인으로 통합.
* **상세 로직:**
  * 서울시 API를 통한 분기별 매출/인구 업데이트.
  * YouTube API를 통한 일일 단위 소셜 데이터(댓글/트렌드) 배치 수집.

---

## **4. 기술 스택 (Technical Stack)**

| 구분 | 기술 스택 | 비고 |
| :---- | :---- | :---- |
| **Frontend** | Next.js 14 (App Router), Deck.gl + react-map-gl | 완전한 UI/UX 제어권, 강력한 3D 맵 인터랙션 |
| **UI/Style** | TailwindCSS + shadcn/ui, Recharts | 세련된 컴포넌트, 반응형 차트 |
| **State** | Zustand | 경량 상태 관리 |
| **Backend** | Python (FastAPI/LangChain) | LLM 오케스트레이션 및 API 관리 |
| **AI Framework** | LangGraph | 순환형 에이전트 워크플로우 제어 |
| **Chat** | Vercel AI SDK | GPT 스트리밍 응답 지원 |
| **Database** | Supabase (PostgreSQL + PostGIS + pgvector) | 관계형 + 공간 + 벡터 데이터 |
| **Content Gen** | Gemini Nano Banana | 4컷 만화/쇼츠 콘텐츠 생성 (Phase 4) |
| **Data Source** | Seoul Open Data, YouTube API | 정량/정성 데이터 하이브리드 수집 |
| **Deploy** | Vercel | 무료 티어, 자동 CI/CD, 엣지 함수 지원 |

### **프론트엔드 전환 근거**

기존 Streamlit + PyDeck 스택은 빠른 프로토타이핑에 유리하나, K-CIA의 핵심 요구사항(3D 맵 클릭 인터랙션, 실시간 챗봇 스트리밍, 복잡한 레이아웃, 100명 동시접속 성능)을 충족하기 어려운 한계가 있음. Next.js + Deck.gl 전환을 통해 다음을 확보:

1. **3D 맵 인터랙션:** Deck.gl은 PyDeck의 원본 라이브러리로 훨씬 강력한 이벤트 핸들링 제공
2. **챗봇 UX:** Vercel AI SDK로 GPT 스트리밍 즉시 구현
3. **성능:** 서버 컴포넌트 + 정적 생성으로 동시접속 처리 용이
4. **배포:** Vercel 무료 티어로 자동 CI/CD 지원

---

## **5. 시각화 및 사용자 경험: Next.js + Deck.gl + TailwindCSS 기반 웹 대시보드**

### **5.0 프론트엔드 UX 목표**

"엑셀 기반 상권 분석"을 아래 경험으로 대체한다:

* 지도에서 직관적으로 위험/기회 구역을 탐색
* 클릭 한 번으로 구역 요약 지표 + 비교 + 추이 확인
* 채팅 한 번으로 근거 기반의 해석/추천을 받음
* 결과는 "리포트/공유 링크" 형태로 저장 가능(회의/의사결정용)

### **5.1 지도 렌더링: Deck.gl HexagonLayer/H3HexagonLayer**

핵심 메타포:

* **높이(Elevation):** 유동인구 또는 매출
* **색(Color):** MVP: 매출증감률(QoQ), 유튜브 모듈 ON 시: 감성 점수(긍/부정)

Deck.gl은 다음 레이어로 이를 직접 지원한다:

* **HexagonLayer:** 포인트를 헥사곤 셀로 집계해 높이/색으로 표현
* **H3HexagonLayer:** H3 셀 인덱스를 직접 렌더링

**인사이트 도출:**

* "높지만 부정(붉은) 기둥": 사람/매출은 많지만 불만(웨이팅/가격/불친절 등)이 큰 위험 구역
* "낮지만 긍정(녹색) 기둥": 아직 덜 알려졌지만 만족도가 높은 잠재 구역

### **5.2 화면 구성(권장)**

**메인 화면:**

* 좌측: 필터(기간/업종/연령/요일/시간대/반경/정성지표 ON/OFF)
* 중앙: 3D Hex 지도
* 우측: 선택 구역 상세(요약 카드 + 차트 + 경쟁도 + "AI에게 질문")

**상세/비교:**

* "A구역 vs B구역" 비교(매출/유동/감성/토픽)
* "분기 추이" + "최근 30일 트렌드(유튜브)" 병렬 시각화

### **5.3 프론트 ↔ 백엔드 연동**

사용자가 hex 클릭 → 프론트는 hex_id(H3 index)를 상태로 저장

**사이드바 요약 로딩:**

```
GET /api/map/hexagon/{h3_index}?qtr=2025Q4&category=cafe
```

**AI 질의:**

```
POST /api/chat
payload: { question, h3_index, filters }
```

백엔드는 LangGraph Supervisor가 필요한 워커(SQL Agent/Insight Agent)를 호출하고, 결과를 합쳐 응답

**중요한 설계 원칙:**

* UI는 "상호작용/표현"에 집중
* 데이터 조회/분석/LLM 비용 통제는 서버(FastAPI + LangGraph)에서 수행
  → 운영/보안/캐싱/쿼터 관리가 쉬워진다.

---

## **6. 사용자 시나리오 (User Journey)**

1. **탐색:** 사용자가 웹 접속 후 성수동 지도의 3D 기둥 높낮이를 보며 핫플레이스 확인.
2. **선택:** 유동 인구가 높은 '연무장길' 구역을 클릭하여 요약 지표(매출 등) 확인.
3. **질의:** "여기에 디저트 카페 차려도 될까?"라고 챗봇에게 질문.
4. **분석:** AI가 "매출은 높으나 카페 포화 상태이며, 최근 유튜브 댓글에서 '대기 장소 부족'에 대한 불만이 많음"을 분석.
5. **결과:** "대기 공간을 확보한 프리미엄 디저트 카페"라는 구체적인 전략 제안 수령.

---

## **7. 성공 지표 (KPIs)**

* **Data Latency:** 소셜 트렌드 반영 주기 **24시간 이내** 유지.
* **Query Accuracy:** 자연어-SQL 변환 성공률 **90% 이상**.
* **User Engagement:** 대시보드 접속 후 평균 질의 횟수 **3회 이상**.

---
