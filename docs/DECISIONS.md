# K-CIA Lite — 의사결정 로그 (DECISIONS.md)

**작성일:** 2026-01-30

---

## DEC-001: 시나리오 1(P1 입지 Top3 추천) 우선 구현 전략

| 항목 | 내용 |
|------|------|
| **날짜** | 2026-01-30 |
| **결정** | 8개 시나리오 중 시나리오 1(P1, 예비 창업자 — 입지 Top3 추천)을 1차 구현 대상으로 확정 |
| **근거** | (1) 핵심 UI 3종(3D Hex맵 + 사이드바 + 챗봇)을 모두 포함하여 플랫폼 뼈대를 세울 수 있음. (2) 필요 데이터셋(D1/D2/D3/D5/D9)이 다른 시나리오에도 공통 사용되어 재사용성이 높음. (3) "카페 창업"이라는 직관적 스토리로 데모/검증이 용이함 |
| **대안** | 시나리오 5(리스크 진단)를 먼저 → 그러나 UI 복잡도가 높고 리스크 레이어 추가 설계 필요. 시나리오 3(팝업)을 먼저 → 타겟 필터(연령/성별) 추가 작업 필요 |
| **영향범위** | M0~M4 전체 마일스톤 구성, 데이터 최소셋 선정, API/UI 설계 |
| **재검토 조건** | 시나리오 1 MVP 완료 후, 사용자 피드백으로 우선순위 재조정 |

---

## DEC-002: 행정동 + 상권코드 병행 구현 (Q1 반영)

| 항목 | 내용 |
|------|------|
| **날짜** | 2026-01-30 |
| **결정** | `dim_area(area_type)` 이원화 + `bridge_area_h3_weight`로 양쪽 모두 H3 매핑. UI에서 "영역 기준(행정동/상권)" 토글 제공. 기본 프리셋은 행정동 4개 + 골목상권 20~40개 |
| **근거** | (1) D1/D5는 상권코드 기준, D2는 행정동 기준으로 제공되어 양쪽 지원이 필수. (2) 사용자에 따라 익숙한 기준이 다름(창업자=상권, 컨설턴트=행정동). (3) 공간조인으로 상호 매핑 가능하나 근사치임을 인지하고 UX에 표기 |
| **대안** | 상권코드만 지원 → D2(점포) 활용 어려움. 행정동만 지원 → D1/D5 정밀도 손실 |
| **영향범위** | dim_area 스키마, bridge 테이블, 모든 API의 `area_type` 파라미터, UI 토글 컴포넌트 |
| **재검토 조건** | 공간조인 오차가 사용자 혼란을 야기할 경우 → 한쪽 기본값 고정 + 다른 쪽은 "고급" 옵션으로 전환 |

---

## DEC-003: 시나리오 1 데이터 최소셋(Must) 확정

| 항목 | 내용 |
|------|------|
| **날짜** | 2026-01-30 |
| **결정** | Must: D1(매출), D5(유동), D2(점포), D3(상권영역), D9(행정동 경계). Should: D11(실시간). Could: D4(상주인구), D8(집객시설) |
| **근거** | (1) 시나리오 1의 6단계(탐색→선택→질의→분석→결과→액션)에서 사용하는 데이터셋을 역추적. (2) D1+D5=맵 시각화 핵심, D2=경쟁 분석 핵심, D3+D9=공간 기준. (3) D11은 후행성 보정에 유용하나 없어도 시나리오 완결 가능. (4) D4/D8은 시나리오 2/3에서 주로 사용 |
| **대안** | D11을 Must로 올림 → 수집 복잡도 증가(실시간 스냅샷), 성수동 장소 존재 미확인 리스크 |
| **영향범위** | M1 전체 작업 범위, ETL 우선순위 |
| **재검토 조건** | D11 장소 확인 후 Should→Must 승격 검토. 시나리오 2 진입 시 D5 시간대 breakdown 검증 |

---

## DEC-004: H3 해상도 기본 res=9 (Q2 반영)

| 항목 | 내용 |
|------|------|
| **날짜** | 2026-01-30 |
| **결정** | H3 기본 해상도 res=9 사용. 성능 문제 시 res=8, 정밀 분석 시 res=10 실험 플래그 제공 |
| **근거** | (1) res=9는 edge 약 174m로 골목 단위 분석에 적합. (2) 성수동 전체 약 100~200개 Hex로 맵 렌더링 성능 충분. (3) DataPlan 문서에서 res=9~10 권장, 확정사항에서 res=9 고정 |
| **대안** | res=10 (edge 약 66m) → Hex 수 5~7배 증가, 렌더링 부하. res=11 (edge 약 25m, CLAUDE.md 초기 기획) → 과도한 세분화 |
| **영향범위** | bridge_area_h3_weight 행 수, 맵 렌더링 성능, API 응답 크기 |
| **재검토 조건** | 맵 렌더링 > 3초 시 res=8 전환 검토. 사용자가 상세 분석 요청 시 res=10 실험 |

---

## DEC-005: 유튜브/소셜 모듈은 Phase 3 이후 (옵션)

| 항목 | 내용 |
|------|------|
| **날짜** | 2026-01-30 |
| **결정** | 유튜브 모듈은 공공데이터 기반 시나리오 4개 이상 안정화 후(Phase 3 이후) 붙임. OFF 상태에서 모든 Q&A/추천이 공공데이터만으로 성립하도록 설계 |
| **근거** | (1) 확정사항: "유튜브/소셜은 옵션, OFF여도 성립". (2) 공공데이터 파이프라인 안정화가 우선. (3) 유튜브 H3 매핑 정밀도 낮음(지역 스코프 수준) |
| **대안** | Phase 1에서 동시 구현 → 범위 확대, 리스크 증가 |
| **영향범위** | Supervisor 라우터(Social Agent 비활성), Insight Agent 응답 템플릿("소셜 데이터 미포함" 문구) |
| **재검토 조건** | 사용자 피드백에서 "왜(원인)" 설명 요구가 높을 경우 Phase 2로 앞당김 |

---

## DEC-006: LLM 모델 선택 (GPT-4o-mini 시작)

| 항목 | 내용 |
|------|------|
| **날짜** | 2026-01-30 |
| **결정** | SQL Agent와 Insight Agent 모두 GPT-4o-mini로 시작. 골든 쿼리 테스트에서 성공률 < 85% 시 GPT-4o로 에스컬레이션 |
| **근거** | (1) 비용 효율(4o-mini는 4o 대비 ~10배 저렴). (2) SQL 생성은 스키마가 단순(테이블 6~7개)하여 4o-mini로 충분할 가능성 높음. (3) 품질 부족 시 전환 경로가 명확(동일 API, 모델명만 변경) |
| **대안** | 처음부터 GPT-4o → 비용 부담 |
| **영향범위** | backend/agents/ 내 모델 설정, API 비용 |
| **재검토 조건** | M4 골든 쿼리 회귀 테스트 결과 |

---

## DEC-007: 콘텐츠 생성(4컷 만화/쇼츠)에 Gemini Nano Banana 사용

| 항목 | 내용 |
|------|------|
| **날짜** | 2026-01-30 |
| **결정** | 시나리오 6(4컷/쇼츠 구조화)의 콘텐츠 생성에 Gemini Nano Banana를 사용. Phase 4에서 도입 |
| **근거** | (1) 4컷 만화/쇼츠는 텍스트+이미지 생성이 필요하며, Gemini Nano Banana가 이 용도에 적합. (2) 기존 GPT-4o는 Q&A/분석에 집중하고, 콘텐츠 생성은 별도 모델로 분리하여 역할 명확화. (3) 비용/성능 최적화 — 콘텐츠 생성은 분석과 다른 특성(멀티모달 출력)을 가짐 |
| **대안** | GPT-4o + DALL-E로 통일 → 모델 의존성 단일화되나 비용 증가. 텍스트만 생성(이미지 없음) → 설득력 저하 |
| **영향범위** | 시나리오 6 구현, backend/agents/에 Content Agent 추가, Gemini API 키 환경변수 추가 |
| **재검토 조건** | Phase 4 진입 시 Gemini Nano Banana API 안정성/품질 평가 후 확정 |
